<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-center-simple.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Learning,机器学习," />










<meta name="description" content="前言之前有大致了解过机器学习相关的知识，最近业余时间在网易云课堂上正式看了NG大大的 机器学习，在收获之余也将学习内容沉淀并赋予实践。">
<meta property="og:type" content="article">
<meta property="og:title" content="初涉机器学习--1.我的第一个机器学习算法">
<meta property="og:url" content="https://blog.lindebiao.top/2019/08/24/%E5%88%9D%E6%B6%89%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-1-%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/index.html">
<meta property="og:site_name" content="程序员小站">
<meta property="og:description" content="前言之前有大致了解过机器学习相关的知识，最近业余时间在网易云课堂上正式看了NG大大的 机器学习，在收获之余也将学习内容沉淀并赋予实践。">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc1a3ee6225107?w=740&h=325&f=png&s=63089">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc1c117861b075?w=344&h=101&f=png&s=4453">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc1c0186cc157a?w=507&h=126&f=png&s=11258">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc1d097a53a0f1?w=158&h=42&f=png&s=1631">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc1d42018e893d?w=1030&h=585&f=png&s=40157">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc2278c8c710ab?w=1043&h=529&f=png&s=46339">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc227f7c677d75?w=640&h=480&f=png&s=37686">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/10/10/16db461fd4c4b5c0?w=487&h=149&f=png&s=11919">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/10/10/16db467eeb9f9a0d?w=254&h=89&f=png&s=5633">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/10/10/16db467953444c1d?w=531&h=128&f=png&s=16476">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/10/10/16db46a5b883cff9?w=422&h=88&f=png&s=12346">
<meta property="og:image" content="https://user-gold-cdn.xitu.io/2019/10/10/16db47198b1b04e7?w=346&h=102&f=png&s=7513">
<meta property="article:published_time" content="2019-08-24T07:44:08.000Z">
<meta property="article:modified_time" content="2019-12-31T08:12:15.882Z">
<meta property="article:author" content="LinsVert">
<meta property="article:tag" content="Learning,机器学习">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://user-gold-cdn.xitu.io/2019/8/24/16cc1a3ee6225107?w=740&h=325&f=png&s=63089">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.lindebiao.top/2019/08/24/初涉机器学习-1-我的第一个机器学习算法/"/>





  <title>初涉机器学习--1.我的第一个机器学习算法 | 程序员小站</title>
  








<meta name="generator" content="Hexo 4.2.0"><!-- hexo-inject:begin --><!-- hexo-inject:end --></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">程序员小站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-question-circle"></i> <br />
            
            About
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.lindebiao.top/2019/08/24/%E5%88%9D%E6%B6%89%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-1-%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="LinsVert">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="程序员小站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">初涉机器学习--1.我的第一个机器学习算法</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-08-24T15:44:08+08:00">
                2019-08-24
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Learning-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" itemprop="url" rel="index">
                    <span itemprop="name">Learning,机器学习</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前有大致了解过机器学习相关的知识，最近业余时间在网易云课堂上正式看了NG大大的 <a href="https://study.163.com/course/courseMain.htm?courseId=1004570029" target="_blank" rel="noopener">机器学习</a>，在收获之余也将学习内容沉淀并赋予实践。</p>
<a id="more"></a>

<h4 id="梯度下降"><a href="#梯度下降" class="headerlink" title="梯度下降"></a>梯度下降</h4><p><a href="https://zh.wikipedia.org/wiki/%E6%A2%AF%E5%BA%A6%E4%B8%8B%E9%99%8D%E6%B3%95" target="_blank" rel="noopener">引用wiki</a>：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">梯度下降法（英语：Gradient descent）是一个一阶最优化算法，通常也称为最速下降法。要使用梯度下降法找到一个函数的局部极小值，必须向函数上当前点对应梯度（或者是近似梯度）的反方向的规定步长距离点进行迭代搜索。</span><br></pre></td></tr></table></figure>
<p>这种可以用来计算一个存在的局部最小值–所能够解释到的就是对一个线性回归函数的参数预测。</p>
<h4 id="线性回归"><a href="#线性回归" class="headerlink" title="线性回归"></a>线性回归</h4><p><a href="https://zh.wikipedia.org/wiki/%E7%B7%9A%E6%80%A7%E5%9B%9E%E6%AD%B8" target="_blank" rel="noopener">引用wiki</a>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在统计学中，线性回归（英语：linear regression）是利用称为线性回归方程的最小二乘函数对一个或多个自变量和因变量之间关系进行建模的一种回归分析。这种函数是一个或多个称为回归系数的模型参数的线性组合。只有一个自变量的情况称为简单回归，大于一个自变量情况的叫做多元回归（multivariate linear regression）</span><br></pre></td></tr></table></figure>

<p>线性回归可以用于预测房价趋势，预测疾病发病率，预测消费支出这种，本文的实例就是预测一个房价数据集中房间面积和售价之间的关系。</p>
<h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p>就单对一组房价数据将，简单地理解为价格和房间面积的关系是线性变化的（假定），那么就存一个<code>预测函数H</code>：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc1a3ee6225107?w=740&h=325&f=png&s=63089" alt=""><br>其中   <code>Hypothesis</code> 就是我们对这个房价预测的一个线性函数，变量x就是房间面积，h就是我们预测的房价而其中的 <code>Parameters</code> $ \theta_0  $ $\theta_1 $  就是我们需要通过预测计算出来的参数，为了计算出 这个两个预测的参数我们需要将预测的函数通过与y值比较求方差，校验预测结果与真实结果的差距–<strong>代价函数（Cost Function）</strong>。</p>
<p>同时我们要让代价函数的代价最小 – 即是让预测函数无限逼近于真实的数据，就是让代价函数的值最小，这样说明预测函数与真实的<code>y 房价</code>的值数据越接近，所以需要一个算法去计算出代价函数的最小值–这样就引出了一个算法 <code>梯度下降(Gradient descent)</code>.</p>
<p>在使用梯度下降算法之前我们要知道一个点，就是如何求一个函数的最小值，简单地说就是通过对函数求导（求斜率），当斜率为零或无限接近0的时候，这个点就是它的局部最小值（可能存在多个斜率为0的函数），那么梯度下降算法要做的就是计算出这个最小值的点。</p>
<p>下图是每个参数的算法公式，其中 $ \alpha $ 是学习率，用于计算下降的速率</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc1c117861b075?w=344&h=101&f=png&s=4453" alt=""></p>
<p>求偏导后，其中 X0 = 1(讲义里定义为 <strong>截距项 intercept term</strong>)， m 为训练数据的数量</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc1c0186cc157a?w=507&h=126&f=png&s=11258" alt="参数计算"></p>
<p>按讲义上的公式，我们只要重复计算，直到代价函数的偏导接近于一个很小的值就能够得到我们预测的参数 $ \theta_j $</p>
<h2 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h2><h3 id="1-数据集"><a href="#1-数据集" class="headerlink" title="1.数据集"></a>1.数据集</h3><p>本次使用的是kaggle上的数据集,是一个叫做 <a href="https://www.kaggle.com/harlfoxem/housesalesprediction" target="_blank" rel="noopener">House Sales in King County, USA</a>的数据集，是美国一个城市 2014年5月~2015年5月房屋售价的数据集合。</p>
<h3 id="2-数据分析"><a href="#2-数据分析" class="headerlink" title="2.数据分析"></a>2.数据分析</h3><p>下载数据后用py查看</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">import pandas as pd</span><br><span class="line"></span><br><span class="line">df &#x3D; pd.read_csv(&quot;input&#x2F;kc_house_data.csv&quot;, )</span><br><span class="line"></span><br><span class="line">print(df.shape)</span><br></pre></td></tr></table></figure>

<p><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc1d097a53a0f1?w=158&h=42&f=png&s=1631" alt="结果"></p>
<p>有21613条数据，通过数据集来源可以看到字段 <code>price</code>售价， <code>sqft_living</code> 是房间面积,那么看下散点图：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">import matplotlib.pyplot as plt</span><br><span class="line"></span><br><span class="line">df &#x3D; df[[&#39;price&#39;, &#39;sqft_living&#39;]]</span><br><span class="line"></span><br><span class="line">#1.绘制价格和房间规格大小的点图</span><br><span class="line"></span><br><span class="line">alt &#x3D; array(df)</span><br><span class="line"></span><br><span class="line">x &#x3D; []</span><br><span class="line">y &#x3D; []</span><br><span class="line">for a in alt:</span><br><span class="line">    x.append(a[1])</span><br><span class="line">    y.append(a[0])</span><br><span class="line">x, y &#x3D; array(x),array(y)</span><br><span class="line"></span><br><span class="line">plt.figure()</span><br><span class="line"></span><br><span class="line">plt.scatter(x, y, s&#x3D;5, c&#x3D;&#39;red&#39;, label &#x3D; &#39;Predicted Regression Line&#39;)</span><br><span class="line"></span><br><span class="line">plt.xlabel(&#39;Living Space (sqft)&#39;)</span><br><span class="line">plt.ylabel(&#39;Price ($)&#39;)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>

<p><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc1d42018e893d?w=1030&h=585&f=png&s=40157" alt=""><br>看上去很酷，接下来就是开始预测了。</p>
<h3 id="3-Coding"><a href="#3-Coding" class="headerlink" title="3.Coding"></a>3.Coding</h3><p>需要预定义一些数据：两个参数的初始值，学习率，代价函数的极限值，数量m</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"># 定义预测函数 h &#x3D; z + z1 * x 预测为线性</span><br><span class="line"># 定义学习率 a</span><br><span class="line">a &#x3D; 0.01</span><br><span class="line"># 定义初始值</span><br><span class="line">z &#x3D; 0</span><br><span class="line">z1 &#x3D; 50</span><br><span class="line"># 数量长度</span><br><span class="line"># 因数值太大 先缩小</span><br><span class="line">x &#x3D; x &#x2F; 1000</span><br><span class="line">y &#x3D; y &#x2F; 1000</span><br><span class="line"></span><br><span class="line">m &#x3D; len(x)</span><br><span class="line"># 定义极限</span><br><span class="line">min_limit &#x3D; 1e-3</span><br></pre></td></tr></table></figure>

<p>定义函数，获取 h:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">def getH(z, z1, x, y):</span><br><span class="line">    return z + z1 * x - y</span><br></pre></td></tr></table></figure>
<p>定义获取 z 偏导结果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">def getZ(z, z1, x, y, m):</span><br><span class="line">    sum &#x3D; 0 </span><br><span class="line">    for i in range(m):</span><br><span class="line">        h &#x3D; getH(z, z1, x[i], y[i])</span><br><span class="line">        sum &#x3D; sum + h</span><br><span class="line">    sum &#x3D; sum * (1.&#x2F; m)</span><br><span class="line">    # newZ &#x3D; z - sum</span><br><span class="line">    return sum</span><br></pre></td></tr></table></figure>
<p>定义 获取 z1 偏导结果:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">def getZ1(z, z1, x, y, m):</span><br><span class="line">    sum &#x3D; 0 </span><br><span class="line">    for i in range(m):</span><br><span class="line">        h &#x3D; getH(z, z1, x[i], y[i])</span><br><span class="line">        h &#x3D; h * x[i]</span><br><span class="line">        sum &#x3D; sum + h</span><br><span class="line">    sum &#x3D; sum * (1.&#x2F; m)</span><br><span class="line">    # newZ1 &#x3D; z1 - sum</span><br><span class="line">    return sum</span><br></pre></td></tr></table></figure>
<p>获取结果 all Z:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">def getAllZ(z, z1, x, y, m, a, min_limit):</span><br><span class="line">    newZ &#x3D; getZ(z, z1, x, y, m)</span><br><span class="line">    newZ1 &#x3D; getZ1(z, z1, x, y, m)</span><br><span class="line">    #梯度下降操作 如果sum 结果比极限值大 则还未接近0，继续梯度下降</span><br><span class="line">    while abs(newZ) &gt;&#x3D; min_limit and abs(newZ1) &gt;&#x3D; min_limit:</span><br><span class="line">        print(&#39;z z1&#39;, z, z1)</span><br><span class="line">        print(&#39;new z new z1&#39;, newZ, newZ1)</span><br><span class="line">        z &#x3D; z - a * newZ</span><br><span class="line">        z1 &#x3D; z1 - a * newZ1</span><br><span class="line">        newZ &#x3D; getZ(z, z1, x, y, m)</span><br><span class="line">        newZ1 &#x3D; getZ1(z, z1, x, y, m)</span><br><span class="line">    print(&#39;new z&#39;, newZ)</span><br><span class="line">    print(&#39;new z1&#39;, newZ1)</span><br><span class="line">    print(&#39;z z1&#39;, z, z1)</span><br><span class="line">    return [z, z1]</span><br></pre></td></tr></table></figure>

<p>最后调用方法获取结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">result &#x3D; getAllZ(z, z1, x, y, m, a, min_limit)</span><br><span class="line">#10条数据 z &#x3D; -13.80519903101423 z1 &#x3D; 225.65934680567906</span><br><span class="line">#全部数据 z &#x3D;  -43.56346904629207 280.61642450710656</span><br><span class="line">def testY(x, result):</span><br><span class="line">    return (result[0] + result[1] * x);</span><br><span class="line">x &#x3D; x * 1000</span><br><span class="line">y &#x3D; y * 1000</span><br><span class="line">text_y &#x3D; []</span><br><span class="line">for i in x:</span><br><span class="line">    # print(i)</span><br><span class="line">    text_y.append(testY(i, result))</span><br><span class="line">    </span><br><span class="line">plt.figure()</span><br><span class="line">plt.scatter(x, y, s&#x3D;5, c&#x3D;&#39;red&#39;, label&#x3D;&#39;Data&#39;)</span><br><span class="line">plt.plot(x, text_y, c&#x3D;&#39;darkgreen&#39;, label&#x3D;&#39;Predicted Regression Line&#39;)</span><br><span class="line">plt.xlabel(&#39;Living Space (sqft)&#39;)</span><br><span class="line">plt.ylabel(&#39;Price ($)&#39;)</span><br><span class="line">plt.xticks(fontsize&#x3D;13)</span><br><span class="line">plt.yticks(fontsize&#x3D;13)</span><br><span class="line">plt.legend()</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>输出绘制的结果图 ：</p>
<p>10条数据的时候：<br><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc2278c8c710ab?w=1043&h=529&f=png&s=46339" alt=""></p>
<p>全部数据（单位/1000）：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/8/24/16cc227f7c677d75?w=640&h=480&f=png&s=37686" alt=""></p>
<p>最后得到预测函数，</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">h &#x3D; -43.56346904629207 + 280.61642450710656 * x</span><br></pre></td></tr></table></figure>
<p>至此预测房价与房间面积的线性回归预测已经全部结束，也是成功记录了本人在学习机器学习原理的第一步！</p>
<h3 id="4-矩阵形式"><a href="#4-矩阵形式" class="headerlink" title="4.矩阵形式"></a>4.矩阵形式</h3><h4 id="2019-10-10更新"><a href="#2019-10-10更新" class="headerlink" title="2019.10.10更新"></a>2019.10.10更新</h4><p>矩阵的基本公式就不放出来了，其实就是其原理的拓展，已知有一下求解预测函数参数的方法：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/10/10/16db461fd4c4b5c0?w=487&h=149&f=png&s=11919" alt=""></p>
<p>代价函数为：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/10/10/16db467eeb9f9a0d?w=254&h=89&f=png&s=5633" alt=""><br>可以转化成矩阵型式，</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/10/10/16db467953444c1d?w=531&h=128&f=png&s=16476" alt=""></p>
<p>其中的推论就不贴出来了，<strong><a href="https://kivy-cn.github.io/Stanford-CS-229-CN/#/Markdown/cs229-notes1" target="_blank" rel="noopener">cs229</a></strong> 有相关推论<br>求偏导后:</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/10/10/16db46a5b883cff9?w=422&h=88&f=png&s=12346" alt=""><br>这样对于$\theta$ 的计算函数为(x, $\theta$ 都为矩阵形式， y为矩阵向量)：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">thea - a * x.T * (x * thea - y) * 1.&#x2F; m</span><br></pre></td></tr></table></figure>
<p>coding 下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">#梯度下降矩阵型式</span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line">import sys</span><br><span class="line">import math</span><br><span class="line">import pandas as pd</span><br><span class="line">import matplotlib.pyplot as plt</span><br><span class="line">import numpy.matlib </span><br><span class="line">import numpy as np</span><br><span class="line"></span><br><span class="line">#导入数据</span><br><span class="line"></span><br><span class="line">df &#x3D; pd.read_csv(&quot;..&#x2F;20190820&#x2F;input&#x2F;kc_house_data.csv&quot;)</span><br><span class="line">#因是简单的一个线性回归 参数先使用2个 price 和 sqft_living</span><br><span class="line">#需要以下矩阵 价格结果矩阵 面积矩阵</span><br><span class="line">y &#x3D; df[[&#39;price&#39;]]</span><br><span class="line">x &#x3D; df[[&#39;sqft_living&#39;]]</span><br><span class="line">m &#x3D; len(x)</span><br><span class="line">a &#x3D; 0.01 #学习率   </span><br><span class="line">#将df 转换成矩阵</span><br><span class="line">y &#x3D; np.asmatrix(y) &#x2F; 1000</span><br><span class="line">x &#x3D; np.asmatrix(x) &#x2F; 1000</span><br><span class="line">#因x0 默认为1 需要一个 1xm的 x0矩阵</span><br><span class="line">x0 &#x3D; np.matlib.ones((m, 1))</span><br><span class="line">#合并矩阵 2 x m</span><br><span class="line">x &#x3D; np.concatenate([x0, x], 1)</span><br><span class="line">#定义thea 目前设置为2个变量 默认为0</span><br><span class="line">thea &#x3D; np.matlib.zeros((2, 1))</span><br><span class="line">diff &#x3D; np.dot(x, thea) - y</span><br><span class="line">diff &#x3D; np.dot(np.transpose(x), diff) * (1.&#x2F;m)</span><br><span class="line">while not np.all(np.absolute(diff) &lt;&#x3D; 1e-5):</span><br><span class="line">	#loop</span><br><span class="line">	thea &#x3D; thea - a * diff</span><br><span class="line">	diff &#x3D; np.dot(x, thea) - y</span><br><span class="line">	diff &#x3D; np.dot(np.transpose(x), diff) * (1.&#x2F;m)</span><br><span class="line">	print(&#39;thea: &#39;, thea)</span><br><span class="line">print(&#39;final thea&#39;, thea)</span><br></pre></td></tr></table></figure>
<p>当 J 的偏导值(绝对值）很小，本文中是1e-5，就可以认为已经到达局部极小值点。<br>跑完结果输出：</p>
<p><img src="https://user-gold-cdn.xitu.io/2019/10/10/16db47198b1b04e7?w=346&h=102&f=png&s=7513" alt=""></p>
<p>结果和上面纯代码型式是一样的，不过矩阵形式代码简洁，少写很多循环代码，对于这种需要大量计算的算法很减少很多的事情。</p>
<p>以上。<br>相关源码地址： <strong><a href="https://github.com/LinsVert/Machine-Learning/tree/master/LinearRegression/20190820" target="_blank" rel="noopener">Gayhub</a></strong></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Learning-%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag"># Learning,机器学习</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/03/13/GO%E5%88%9D%E4%BD%93%E9%AA%8C%E4%B9%8B%E7%88%AC%E5%8F%96%E6%83%85%E4%BE%A3%E5%A4%B4%E5%83%8F/" rel="next" title="GO初体验之爬取情侣头像">
                <i class="fa fa-chevron-left"></i> GO初体验之爬取情侣头像
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/11/12/%E5%88%9D%E6%B6%89%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0-3-%E7%94%9F%E6%88%90%E5%AD%A6%E4%B9%A0%E7%AE%97%E6%B3%95%E4%B9%8B%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%88%86%E7%B1%BB%E5%99%A8/" rel="prev" title="初涉机器学习--3.生成学习算法之朴素贝叶斯分类器">
                初涉机器学习--3.生成学习算法之朴素贝叶斯分类器 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">LinsVert</p>
              <p class="site-description motion-element" itemprop="description">一只想变成咸鱼的猿。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">categories</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/LinsVert" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:lindebiaoldb@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.jianshu.com/u/6b1fa1764b51" target="_blank" title="简书">
                      
                        <i class="fa fa-fw fa-globe"></i>简书</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://juejin.im/user/5995568cf265da24701e9d67" target="_blank" title="掘金">
                      
                        <i class="fa fa-fw fa-globe"></i>掘金</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>
      <div class='music163'>
        <iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width="330" height="86" src="//music.163.com/outchain/player?type=2&id=26908739&auto=1&height=66"></iframe>
      </div>
      
      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.</span> <span class="nav-text">前言</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#梯度下降"><span class="nav-number">1.0.1.</span> <span class="nav-text">梯度下降</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#线性回归"><span class="nav-number">1.0.2.</span> <span class="nav-text">线性回归</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#基本概念"><span class="nav-number">2.</span> <span class="nav-text">基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#实践"><span class="nav-number">3.</span> <span class="nav-text">实践</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-数据集"><span class="nav-number">3.1.</span> <span class="nav-text">1.数据集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-数据分析"><span class="nav-number">3.2.</span> <span class="nav-text">2.数据分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-Coding"><span class="nav-number">3.3.</span> <span class="nav-text">3.Coding</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-矩阵形式"><span class="nav-number">3.4.</span> <span class="nav-text">4.矩阵形式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#2019-10-10更新"><span class="nav-number">3.4.1.</span> <span class="nav-text">2019.10.10更新</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">LinsVert</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script><!-- hexo-inject:begin --><!-- Begin: Injected MathJax -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config("");
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
      all[i].SourceElement().parentNode.className += ' has-jax';
    }
  });
</script>

<script type="text/javascript" src="">
</script>
<!-- End: Injected MathJax -->
<!-- hexo-inject:end -->
  


  

  

</body>
</html>
